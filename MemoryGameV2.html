<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Emoji Memory Game</title>

<style>

#floating-message {
    position: absolute;
    top: 10%;
    left: 50%;
    transform: translateX(-50%);
    pointer-events: none;
    font-size: 40px;
    font-weight: bold;
    color: #333;
    opacity: 0;
    will-change: opacity, transform;
}

    body {
        font-family: Arial, sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background: #f4f4f4;
        overflow: hidden;
    }
    .game-container {
        display: grid;
        grid-template-columns: repeat(4, 80px);
        gap: 10px;
    }
    .card {
        width: 80px;
        height: 80px;
        background: white;
        border-radius: 10px;
        font-size: 40px;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        border: 2px solid #ddd;
        user-select: none;
        transition: background 0.3s, transform 0.3s;
    }
    .card.flipped {
        background: #fffbe7;
    }
    .card.matched {
        background: #b6f7c1;
        cursor: default;
        animation: spin 1s ease-in-out;
    }

    /* Rotation animation */
    @keyframes spin {
        0% { transform: rotate(0deg); }
        50% { transform: rotate(360deg); }
        100% { transform: rotate(360deg); }
    }

    /* Simple confetti style */
    .confetti {
		position: fixed;
		top: 0;
		left: 0;
		pointer-events: none;
		will-change: transform, opacity;
    }

    @keyframes fall {
        to {
            transform: translateY(500px) rotate(360deg);
            opacity: 0;
        }
    }
</style>
</head>
<body>

<div id="floating-message"></div>
<div class="game-container" id="game"></div>

<script>
let comboCount = 0;
let matchedPairs = 0;
const totalPairs = 8;  // you have 8 pairs

const comboMessages = [
    null,                       // combo 0
    null,                       // combo 1 (normal match)
    "Combo x2!",                // combo 2
    "Combo x3 â€” On Fire!",      // combo 3
    "Combo x4 â€” Crushing It!",  // combo 4
    "Combo x5 â€” Unstoppable!",  // combo 5
    "Combo x6 â€” Godlike!",      // combo 6+
];
const praiseMessages = ["Nice!", "Great!", "Awesome!", "Fantastic!", "Sweet!", "Boom!"];
const emojis = ["ðŸ¶","ðŸ±","ðŸ¼","ðŸ¦Š","ðŸ¸","ðŸµ","ðŸ·","ðŸ™"];
let cards = [...emojis, ...emojis];

cards.sort(() => Math.random() - 0.5);

const game = document.getElementById("game");

let firstCard = null;
let secondCard = null;
let lockBoard = false;

// Create cards
cards.forEach((emoji) => {
    const card = document.createElement("div");
    card.classList.add("card");
    card.dataset.emoji = emoji;
    card.textContent = "";

    card.addEventListener("click", () => flipCard(card));
    game.appendChild(card);
});

function flipCard(card) {
    if (lockBoard || card.classList.contains("matched")) return;
    if (card === firstCard) return;

    card.textContent = card.dataset.emoji;
    card.classList.add("flipped");

    if (!firstCard) {
        firstCard = card;
        return;
    }

    secondCard = card;
    checkMatch();
}

function checkMatch() {
    const isMatch = firstCard.dataset.emoji === secondCard.dataset.emoji;

	if (isMatch) {
		firstCard.classList.add("matched");
		secondCard.classList.add("matched");

		matchedPairs++;

		comboCount++;

		// ðŸ”¥ Send praise & combo message
		showPraiseMessage(comboCount);

		// Screen shake for big combos
		if (comboCount >= 3) {
			screenShake(comboCount);
		}

		// Confetti strength scaled to combo
		const strength = comboCount >= 2 ? comboCount : 1;
		const particles = 40 + comboCount * 20;

		fireConfetti(strength, particles);

		// Win celebration
		if (matchedPairs === totalPairs) {
			setTimeout(() => {
				showWinMessage();
				celebrateWin();
			}, 300);
		}

		resetChoices();
	} else {
		comboCount = 0;
		lockBoard = true;

		setTimeout(() => {
			firstCard.textContent = "";
			secondCard.textContent = "";
			firstCard.classList.remove("flipped");
			secondCard.classList.remove("flipped");
			resetChoices();
		}, 800);
	}
	}

function celebrateWin() {
    // Huge celebration burst
    for (let i = 0; i < 10; i++) {    
        setTimeout(() => {
            fireConfetti(3, 120);  // strong & many
        }, i * 200);
    }
}


function resetChoices() {
    [firstCard, secondCard] = [null, null];
    lockBoard = false;
}

/* ðŸŽ‰ Simple Confetti Burst */
/* ðŸŽ‰ Particle-System Confetti */
function fireConfetti(strength = 1, particleCount = 40) {
    for (let i = 0; i < particleCount; i++) {
        createConfettiParticle(strength);
    }
}

function createConfettiParticle(strength) {
    const confetti = document.createElement("div");
    confetti.classList.add("confetti");

    // Random color
    confetti.style.backgroundColor = randomColor();

    // Random size
    const size = 6 + Math.random() * 6 * strength;
    confetti.style.width = size + "px";
    confetti.style.height = size + "px";

    // Start position anywhere on screen when strength >= 3 (win)
    const startX = strength >= 3
        ? Math.random() * window.innerWidth
        : window.innerWidth / 2;

    const startY = strength >= 3
        ? Math.random() * window.innerHeight
        : window.innerHeight / 2;

    // Random velocity scaled by strength
    const angle = Math.random() * Math.PI * 2;
    const speed = (2 + Math.random() * 4) * strength;

    const velocity = {
        x: Math.cos(angle) * speed,
        y: Math.sin(angle) * speed - (1 * strength)
    };

    // Lifetime distribution (80% short)
    const shortLife = 0.5 + Math.random() * 0.5;
    const longLife = 1 + Math.random() * 2;
    const lifetimeSeconds = Math.random() < 0.8 ? shortLife : longLife;
    const lifetime = lifetimeSeconds * 1000;

    const finalOpacity = Math.random() * 0.6;
    let startTime = performance.now();

    const rotation = Math.random() * 360;
    const spinSpeed = (Math.random() * 400 - 200) * strength;

    document.body.appendChild(confetti);

    function animate(t) {
        const elapsed = t - startTime;
        const progress = elapsed / lifetime;

        if (progress >= 1) {
            confetti.remove();
            return;
        }

        const x = startX + velocity.x * elapsed * 0.5;
        const y = startY + velocity.y * elapsed * 0.5 +
                  0.001 * elapsed * elapsed * strength;

        const opacity = 1 - progress + finalOpacity * progress;

        confetti.style.transform = `
            translate(${x}px, ${y}px)
            rotate(${rotation + spinSpeed * progress}deg)
        `;
        confetti.style.opacity = opacity;

        requestAnimationFrame(animate);
    }

    requestAnimationFrame(animate);
}

function showPraiseMessage(combo) {
    const msg = document.getElementById("floating-message");

    // Pick base praise message
    let phrase = praiseMessages[Math.floor(Math.random() * praiseMessages.length)];

    // Override with combo message if combo >= 2
    if (combo >= 2) {
        phrase = comboMessages[Math.min(combo, comboMessages.length - 1)];
    }

    // Special coloring for combos
    let color = "#333";
    if (combo === 2) color = "#0077FF";
    else if (combo === 3) color = "#FF7700";
    else if (combo === 4) color = "#FF0055";
    else if (combo >= 5) color = "#AA00FF";

    msg.style.color = color;
    msg.textContent = phrase;

    let startTime = performance.now();

    // Random tilt angle
    const tilt = (Math.random() * 20) - 10;

    const startY = 40;
    const endY = 0;

    // animation length
    const duration = 900;

    function animate(t) {
        const elapsed = t - startTime;
        const progress = Math.min(elapsed / duration, 1);

        // cubic-out = deceleration
        const ease = 1 - Math.pow(1 - progress, 3);

        const y = startY + (endY - startY) * ease;
        const opacity = ease <= 0.4 ? ease * 2.5 : (1 - ease) * 2.5;

        msg.style.opacity = opacity;
        msg.style.transform = `
            translateX(-50%)
            translateY(${y}px)
            rotate(${tilt}deg)
            scale(${1 + ease * 0.3})
        `;

        if (progress < 1) {
            requestAnimationFrame(animate);
        } else {
            msg.style.opacity = 0;
        }
    }

    requestAnimationFrame(animate);
}
function screenShake(intensity) {
    const duration = 200;
    const shakeAmount = intensity * 2;

    const game = document.body;
    const start = performance.now();

    function shake(t) {
        const elapsed = t - start;
        if (elapsed > duration) {
            game.style.transform = "";
            return;
        }

        const power = (1 - elapsed / duration) * shakeAmount;
        const x = (Math.random() - 0.5) * power;
        const y = (Math.random() - 0.5) * power;

        game.style.transform = `translate(${x}px, ${y}px)`;
        requestAnimationFrame(shake);
    }

    requestAnimationFrame(shake);
}

function showWinMessage() {
    const msg = document.getElementById("floating-message");
    msg.textContent = "YOU WIN!";
    msg.style.color = "#00AA44"; // celebratory green

    let startTime = performance.now();
    const duration = 2000;

    function animate(t) {
        const elapsed = t - startTime;
        const progress = Math.min(elapsed / duration, 1);

        const bounce = Math.sin(progress * Math.PI);
        const opacity = progress < 0.5 ? progress * 2 : (1 - progress) * 2;

        msg.style.opacity = opacity;
        msg.style.transform = `
            translateX(-50%)
            translateY(${-(bounce * 30)}px)
            scale(${1 + bounce * 0.8})
            rotate(${Math.sin(progress * 8) * 5}deg)
        `;

        if (progress < 1) {
            requestAnimationFrame(animate);
        } else {
            msg.style.opacity = 0;
        }
    }

    requestAnimationFrame(animate);
}

function randomColor() {
    const colors = ["#FF5733","#FFC300"];
    return colors[Math.floor(Math.random()*colors.length)];
}
</script>
</body>
</html>
